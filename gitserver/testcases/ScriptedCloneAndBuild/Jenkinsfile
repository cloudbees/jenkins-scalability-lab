node {
    withEnv(["JAVA_HOME=${ tool 'jdk8' }", "PATH+MAVEN=${tool 'maven'}/bin:${env.JAVA_HOME}/bin"]) {
    
    // def mvnHome = tool 'maven'
    // def java = tool 'jdk8'

    stage ('Sanity Check') {
        echo "where is maven"
        sh "which mvn"
        echo "where is java"
        sh "which java"
    }
    
    stage('Check out') { 
        git 'https://github.com/jglick/simple-maven-project-with-tests.git'
    }
    
    stage('Build it') {
        sh "'${mvnHome}/bin/mvn' -Dmaven.test.failure.ignore clean package"
    }
    
    stage('Archive our results') {
        junit '**/target/surefire-reports/TEST-*.xml'
        archive 'target/*.jar'
    }
}

}